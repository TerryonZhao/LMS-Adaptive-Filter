close all;
clc;


 h_sin = [.00611868;
        .0078714;
        .00940182;
        .0106632;
        .0116183;
        .0122381;
        .0125087;
        .0124151;
        .0119644;
        .0111676;
        .0100462;
        .00862901;
        .00696222;
        .00508823;
        .00306373;
        .000946229;
        -.00120326;
        -.00332236;
        -.00534974;
        -.00722836;
        -.00890035;
        -.0103194;
        -.0114426;
        -.0122376;
        -.0126813;
        -.0127589;
        -.0124664;
        -.0118132;
        -.0108157;
        -.00950104;
        -.00790918;
        -.00608452;
        -.00407815;
        -.00194941;
        .000243349;
        .00243289;
        .00455866;
        .00655702;
        .00836954;
        .00994616;
        .0112386;
        .0122102;
        .0128282;
        .0130787;
        .0129499;
        .0124454;
        .011578;
        .0103715;
        .00886241;
        .00708973;
        .00510801;
        .00297056;
        .00074363;
        -.00151429;
        -.00373364;
        -.00585271;
        -.00780736;
        -.00954061;
        -.0110041;
        -.0121513;
        -.0129502;
        -.0133754;
        -.0134141;
        -.0130628;
        -.0123311;
        -.0112373;
        -.00981512;
        -.00810332;
        -.00615151;
        -.00401387;
        -.00175253;
        .000567634;
        .00287872;
        .00511458;
        .00720823;
        .0090991;
        .0107315;
        .0120577;
        .0130379;
        .0136425;
        .0138519;
        .0136607;
        .0130699;
        .0120967;
        .0107705;
        .00912412;
        .00720836;
        .00507533;
        .00278774;
        .000411414;
        -.00198554;
        -.00433125;
        -.00656149;
        -.00860753;
        -.0104105;
        -.0119161;
        -.0130812;
        -.0138669;
        -.0142538;
        -.0142251;
        -.0137844;
        -.012939;
        -.0117144;
        -.0101433;
        -.00827141;
        -.00615126;
        -.00384478;
        -.00141808;
        .00105814;
        .00351379;
        .00587455;
        .00807436;
        .0100461;
        .0117331;
        .0130845;
        .014059;
        .0146295;
        .0147744;
        .0144892;
        .0137823;
        .0126686;
        .0111848;
        .00936767;
        .00727125;
        .00495444;
        .00248516;
        -6.73399e-5;
        -.00262758];

 h_bb = [.0222325;
        -.0139671;
        -.0305184;
        -.0307636;
        -.0101165;
        -.000200581;
        .00550817;
        -.00149264;
        -.0170492;
        -.0268676;
        -.0214635;
        .00134159;
        .0226597;
        .0225511;
        .00109679;
        -.0224108;
        -.0280385;
        -.0228094;
        -.00268563;
        .0137355;
        .0180825;
        .0111368;
        -.0149742;
        -.0294231;
        -.0306827;
        -.0160451;
        .0032811;
        -.00678058;
        -.026303;
        -.0364341;
        -.0413457;
        -.0178154;
        .0100546;
        .0190829;
        .0319895;
        .0257628;
        .0164719;
        .0208493;
        .0180724;
        .0281953;
        .0257796;
        .00913213;
        .00850601;
        .0231608;
        .0431035;
        .0528096;
        .0500973;
        .0313528;
        .0256348;
        .0451643;
        .0536033;
        .0403724;
        .0281472;
        .0119722;
        9.23611e-6;
        -.0337887;
        -.0992857;
        -.123698;
        -.0714675;
        .0238356;
        .0697147;
        .0271743;
        -.0606042;
        -.120834;
        -.0925527;
        -.0243003;
        -.00196787;
        -.0208312;
        -.0673055;
        -.115875;
        -.0792391;
        -.00596349;
        .0874122;
        .176433;
        .12259;
        .0391578;
        .00138033;
        -.0276105;
        -.00353472;
        .01858;
        .00183158;
        -.0110577;
        -.00393337;
        .00570718;
        .0029915;
        -.00199942;
        -.00130829;
        .00114979;
        .00107999;
        -.000411593;
        -.000745858;
        -.000142838;
        .000160664;
        .000110064;
        -.000227725;
        -.000354958;
        -.00034311;
        -.000254735;
        -.000147984;
        -2.7051e-7;
        1.18658e-5;
        -7.15179e-5;
        1.8272e-5;
        .000132489;
        .000585346;
        .00107692;
        .00106946;
        .00112041;
        .000995935;
        .000797515;
        .00122163;
        .0013991;
        .00106644;
        .00100282;
        .000814768;
        .000801713;
        .000838398;
        .000536345;
        .000387848;
        .000319982;
        8.47191e-5;
        -.000361454;
        -.000511269;
        -.000703714;
        -.000801431;
        -.000726675;
        -.00130935;
        -.00205656];



%% Question 2

f_s = 16000;    % Hz
h = flipud(h_bb);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h(n)'
set(gca,'LooseInset',get(gca,'TightInset'))

figure('Color','white');
subplot(2,1,1);
plot(w/f_s,20*log10(abs(H))); grid on;
xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
subplot(2,1,2)
plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
set(gca,'LooseInset',get(gca,'TightInset'))