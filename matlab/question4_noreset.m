close all;
clc;


h_100 = [-.0111517;
        -.00996642;
        -.0084786;
        -.00673193;
        -.0047771;
        -.00267155;
        -.000477337;
        .00174003;
        .00391507;
        .00598194;
        .00787966;
        .00954987;
        .0109433;
        .0120159;
        .0127353;
        .013079;
        .0130343;
        .0126019;
        .0117923;
        .0106289;
        .00914475;
        .00738257;
        .00539442;
        .00323757;
        .000976705;
        -.0013217;
        -.00358929;
        -.00575809;
        -.00776304;
        -.0095443;
        -.0110475;
        -.0122271;
        -.0130466;
        -.0134804;
        -.0135138;
        -.0131445;
        -.012382;
        -.0112466;
        -.00977226;
        -.00800065;
        -.00598357;
        -.00378073;
        -.0014562;
        .000920183;
        .00327869;
        .00554859;
        .0076611;
        .00955356;
        .0111684;
        .0124564;
        .0133782;
        .0139049;
        .0140182;
        .013715;
        .0130015;
        .0118985;
        .0104367;
        .00865794;
        .00661457;
        .00436666;
        .00197977;
        -.000475083;
        -.00292498;
        -.00529719;
        -.00752018;
        -.00952763;
        -.0112589;
        -.012661;
        -.013692;
        -.0143187;
        -.0145208;
        -.0142918;
        -.0136362;
        -.0125722;
        -.0111298;
        -.00935004;
        -.00728667;
        -.0049981;
        -.00255278;
        -2.2992e-5;
        .00251678;
        .00498973;
        .00732331;
        .00944618;
        .0112948;
        .0128125;
        .0139537;
        .0146824;
        .0149759;
        .0148229;
        .0142275;
        .0132051;
        .0117849;
        .0100082;
        .00792576;
        .00559911;
        .00309608;
        .000491139;
        -.00213821;
        -.00471445];

h_10 = [.0139304;
        .0129144;
        .0115092;
        .00975561;
        .00770395;
        .00541459;
        .00295435;
        .000396458;
        -.00218303;
        -.00470805];

%----------------------------- 10 to 100--------------------
h_10_2 = [.220236;
        .18828;
        .150707;
        .108666;
        .0633817;
        .0162143;
        -.0314363;
        -.078153;
        -.122538;
        -.163278];

h_100_2 = [0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        0;
        .220236;
        .18828;
        .150707;
        .108666;
        .0633817;
        .0162143;
        -.0314363;
        -.078153;
        -.122538;
        -.163278];


%% Question 4

f_s = 16000;    % Hz
h = flipud(h_100_2);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h(n)'
set(gca,'LooseInset',get(gca,'TightInset'))

% figure('Color','white');
% subplot(2,1,1);
% plot(w/f_s,20*log10(abs(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
% subplot(2,1,2)
% plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
% set(gca,'LooseInset',get(gca,'TightInset'))