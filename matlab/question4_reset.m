close all;
clc;


h_100 = [-.0124348;
        -.0111569;
        -.00954687;
        -.00765314;
        -.00553092;
        -.00324437;
        -.000860941;
        .00154814;
        .00391112;
        .00615751;
        .00822093;
        .0100391;
        .0115583;
        .0127329;
        .0135287;
        .0139219;
        .0139003;
        .0134648;
        .0126279;
        .0114148;
        .00986218;
        .00801591;
        .00593092;
        .00366916;
        .00129801;
        -.00111169;
        -.00348835;
        -.00576101;
        -.00786267;
        -.00972894;
        -.0113065;
        -.0125465;
        -.0134142;
        -.0138814;
        -.0139351;
        -.0135742;
        -.0128095;
        -.0116621;
        -.0101685;
        -.00837119;
        -.00632522;
        -.00409057;
        -.00173433;
        .000673685;
        .00306174;
        .00535849;
        .00749562;
        .0094095;
        .0110429;
        .0123483;
        .0132853;
        .0138269;
        .0139566;
        .0136703;
        .0129773;
        .0118979;
        .0104639;
        .00871852;
        .00671314;
        .00450808;
        .00216878;
        -.000235228;
        -.00263219;
        -.00495067;
        -.00712183;
        -.00908063;
        -.0107694;
        -.0121372;
        -.0131439;
        -.0137585;
        -.0139639;
        -.0137531;
        -.0131329;
        -.0121216;
        -.0107491;
        -.00905681;
        -.00709453;
        -.00492114;
        -.00260098;
        -.000203524;
        .00220007;
        .00453811;
        .00674099;
        .00874286;
        .0104849;
        .0119146;
        .0129891;
        .0136768;
        .0139574;
        .0138223;
        .0132757;
        .0123333;
        .0110237;
        .00938565;
        .00746896;
        .00532933;
        .00303088;
        .000642177;
        -.00176562;
        -.00412071];

h_10 = [.222719;
        .19095;
        .153498;
        .111481;
        .0661429;
        .0188286;
        -.0290504;
        -.0760709;
        -.120837;
        -.162014];

%------------------------reset------------------------
h_10_2 = [.217072;
        .186085;
        .149561;
        .108572;
        .064356;
        .0182208;
        -.028456;
        -.0742842;
        -.117904;
        -.158007];

h_100_2 = [-.0123312;
        -.0110309;
        -.00940186;
        -.00749332;
        -.00536137;
        -.00306982;
        -.000686803;
        .00171665;
        .00406889;
        .00630002;
        .00834379;
        .0101389;
        .0116318;
        .0127781;
        .0135442;
        .013907;
        .0138555;
        .0133919;
        .0125286;
        .011293;
        .00972045;
        .00785863;
        .00576246;
        .00349512;
        .00112351;
        -.00128161;
        -.00364845;
        -.00590668;
        -.00798902;
        -.00983365;
        -.0113849;
        -.0125976;
        -.0134352;
        -.0138718;
        -.0138961;
        -.0135066;
        -.012714;
        -.0115439;
        -.0100292;
        -.00821613;
        -.00615819;
        -.00391708;
        -.00155916;
        .000845145;
        .00322435;
        .0055074;
        .00762657;
        .00951861;
        .011127;
        .0124043;
        .0133117;
        .0138231;
        .0139225;
        .0136078;
        .0128874;
        .0117835;
        .0103281;
        .00856541;
        .00654801;
        .00433518;
        .00199334;
        -.000407901;
        -.00279704;
        -.00510256;
        -.00725655;
        -.00919397;
        -.0108582;
        -.0121987;
        -.0131756;
        -.0137605;
        -.0139357;
        -.0136956;
        -.0130478;
        -.0120112;
        -.0106172;
        -.00890667;
        -.00693099;
        -.00474895;
        -.00242546;
        -2.98007e-5;
        .0023668;
        .00469296;
        .00687937;
        .00886075;
        .0105784;
        .0119811;
        .0130268;
        .0136843;
        .0139349;
        .0137701;
        .0131953;
        .0122275;
        .0108953;
        .00923917;
        .00730743;
        .00515831;
        .0028553;
        .000467553;
        -.00193418;
        -.00427848];


%% Question 4

f_s = 16000;    % Hz
h = flipud(h_100_2);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h(n)'
set(gca,'LooseInset',get(gca,'TightInset'))

% figure('Color','white');
% subplot(2,1,1);
% plot(w/f_s,20*log10(abs(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
% subplot(2,1,2)
% plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
% set(gca,'LooseInset',get(gca,'TightInset'))