close all;
clc;

h_100 = [.0107501;
        -.0200152;
        -.0211792;
        .00370699;
        .0219257;
        .0133372;
        .00973435;
        .00176235;
        -.00134355;
        -.00225193;
        -.00189675;
        .0197809;
        .0374486;
        .0299934;
        .0154886;
        .00671112;
        .0131339;
        .0305489;
        .0335455;
        .0199731;
        .00265994;
        .00410257;
        .0133403;
        .00731113;
        -.00878189;
        -.0297802;
        -.0240766;
        -.0231219;
        -.0352579;
        -.0324478;
        -.00475974;
        .0408827;
        .057305;
        .0261339;
        -.0342911;
        -.0642203;
        -.0363292;
        .00252717;
        -.0062705;
        -.0439367;
        -.0833808;
        -.0951217;
        -.0436145;
        .00884264;
        .0670616;
        .105364;
        .0638015;
        .0256723;
        .00308676;
        -.0152743;
        -.00132875;
        .00914603;
        .000583927;
        -.00508353;
        -.000506716;
        .00401076;
        .00207978;
        -.000346787;
        .000624036;
        .00170278;
        .000987397;
        .000309454;
        .000606197;
        .00113925;
        .000971626;
        .00035947;
        -3.43335e-5;
        2.02339e-5;
        -6.83778e-5;
        2.39104e-5;
        .000139572;
        .000422389;
        .000254826;
        -.000291573;
        -.000268584;
        -.000394492;
        -.00027067;
        -.000284909;
        -.000494491;
        -.000524506;
        -.00042122;
        -.000663295;
        -.000545406;
        -.000597289;
        -.000597471;
        -.000254397;
        -.000286597;
        -5.17444e-5;
        .000293275;
        .000700811;
        .000652586;
        .000291229;
        4.09327e-5;
        .000157713;
        .000759026;
        .000852955;
        .000645293;
        .000806483;
        .000791344;
        .00126867];

h_50 = [.000461311;
        .0087155;
        -.00432389;
        -.0123789;
        -.000284448;
        .00805732;
        -.00116404;
        -.007789;
        -.000483728;
        .00507628;
        -.000236499;
        -.00474741;
        -.00149141;
        .0015897;
        -.00081179;
        -.00305295;
        -.000962165;
        .000902599;
        -.000710432;
        -.00234073;
        -.00190267;
        -.00018352;
        .000193451;
        -.000299783;
        -.000452799;
        -.000654545;
        -.00108105;
        -.00138465;
        -.000878979;
        -.00041572;
        -.000731624;
        -.00133191;
        -.00127353;
        -.00122751;
        -.00108009;
        -.00102318;
        -.00106555;
        -.00109497;
        -.00136588;
        -.0014574;
        -.00122868;
        -.000884034;
        -.00117767;
        -.00134492;
        -.00185199;
        -.00208202;
        -.00199021;
        -.00146956;
        -.00134043;
        -.00163629];

h_25 = [0;
        0;
        -.00138465;
        -.000878979;
        -.00041572;
        -.000731624;
        -.00133191;
        -.00127353;
        -.00122751;
        -.00108009;
        -.00102318;
        -.00106555;
        -.00109497;
        -.00136588;
        -.0014574;
        -.00122868;
        -.000884034;
        -.00117767;
        -.00134492;
        -.00185199;
        -.00208202;
        -.00199021;
        -.00146956;
        -.00134043];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h_100_reset = [.00959413;
        -.0202488;
        -.0232024;
        .00119258;
        .0181485;
        .0137997;
        .0145179;
        .00615114;
        -.00196993;
        -.00501504;
        -.00480937;
        .017861;
        .0393949;
        .0315537;
        .0151647;
        .00480281;
        .00934349;
        .0302004;
        .0349175;
        .0194183;
        .000592931;
        .0014548;
        .0121388;
        .00922631;
        -.00571798;
        -.0283269;
        -.0211597;
        -.0207099;
        -.0363793;
        -.0399449;
        -.0152999;
        .0424066;
        .0671608;
        .0365451;
        -.0335178;
        -.0806865;
        -.0529044;
        .00061961;
        .00602774;
        -.030536;
        -.0795647;
        -.103475;
        -.0529271;
        .00631922;
        .068681;
        .113026;
        .0675028;
        .023908;
        .00228883;
        -.0170075;
        -.00127721;
        .0112057;
        .00142213;
        -.00598715;
        -.00154996;
        .00353999;
        .00181671;
        -.00121787;
        -.000738911;
        .00102592;
        .00112231;
        .000324619;
        -.000272806;
        -.000263091;
        -.000307705;
        -.00026682;
        -.00026597;
        -.000217707;
        -.000126594;
        7.70991e-6;
        -3.59402e-5;
        -.000314017;
        -.000265381;
        .000122363;
        .000562805;
        .000705943;
        .00029074;
        -4.53758e-5;
        -.000369161;
        -.000209876;
        -9.66837e-5;
        -.000416968;
        -.000337111;
        -.000140943;
        -.000107306;
        .000110342;
        .000210699;
        .000303599;
        .000371236;
        .000424958;
        .000287229;
        .000138421;
        .000501208;
        .000497651;
        .000613722;
        .000468336;
        -2.56336e-5;
        -.000187653;
        -.000242928;
        .000102074];

h_50_reset = [.00239125;
        .000949371;
        -.000899339;
        -.00072014;
        .000496576;
        .000849565;
        .00118288;
        .00193598;
        .00227787;
        .00254178;
        .00263989;
        .0022996;
        .00178516;
        .00118675;
        .000569977;
        .000287727;
        -3.54516e-5;
        -.000106787;
        -.000904108;
        -.00218866;
        -.00243459;
        -.0024963;
        -.00207325;
        -.0016277;
        -.00214911;
        -.00249415;
        -.00247231;
        -.00223593;
        -.00173011;
        -.00165594;
        -.00149313;
        -.00121131;
        -.00118316;
        -.00131538;
        -.00174433;
        -.00185746;
        -.000984645;
        -.000394861;
        -2.10066e-5;
        .000267297;
        .000661541;
        .00128641;
        .00168295;
        .00145139;
        .00094524;
        .00103583;
        .00116875;
        .000989727;
        .0004442;
        .000336381];

h_25_reset = [-.00073096;
        -.00100334;
        -.00148789;
        -.000986922;
        -.000131364;
        .00159042;
        .00249649;
        .00147746;
        .000148261;
        -.000240166;
        -.000382737;
        -8.99498e-5;
        .000152349;
        .000279403;
        .000658418;
        .000769179;
        .000313199;
        -.000228125;
        -.00119843;
        -.00196004;
        -.00231739;
        -.00234095;
        -.00164418;
        -.00088629;
        -.000366779];

%% Question 3

f_s = 16000;    % Hz
h = flipud(h_100);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h(n)'
set(gca,'LooseInset',get(gca,'TightInset'))
% ylim([-0.15, 0.15]); % 设置Y轴的范围

% figure('Color','white');
% subplot(2,1,1);
% plot(w/f_s,20*log10(abs(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
% subplot(2,1,2)
% plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
% set(gca,'LooseInset',get(gca,'TightInset'))