close all;
clc;

h_sin2bb =  [.0022823;
        -.010765;
        -.0189942;
        -.0195269;
        -.0127164;
        -.0050975;
        -.0017596;
        -.00582499;
        -.0134492;
        -.0164455;
        -.0113123;
        .000107059;
        .00946507;
        .00919206;
        -.00113415;
        -.0136399;
        -.0193547;
        -.0160719;
        -.00486039;
        .00508724;
        .00734249;
        .000880262;
        -.0118541;
        -.0200359;
        -.0210711;
        -.0160359;
        -.0103424;
        -.0137948;
        -.0215754;
        -.0265345;
        -.026134;
        -.013655;
        .00329941;
        .0157144;
        .0247854;
        .0250871;
        .0224221;
        .0220214;
        .0199585;
        .019713;
        .0172629;
        .013539;
        .0161644;
        .0245833;
        .0343161;
        .0399742;
        .0402139;
        .0361113;
        .0344097;
        .0384114;
        .0405739;
        .0375015;
        .0298062;
        .0118903;
        -.0148933;
        -.0480136;
        -.076336;
        -.0768985;
        -.0453503;
        -.00188464;
        .0186754;
        .000930592;
        -.0384536;
        -.0689958;
        -.0667909;
        -.0433212;
        -.0300989;
        -.0370603;
        -.0590123;
        -.0735325;
        -.0471073;
        .00744644;
        .068612;
        .111232;
        .0986537;
        .058502;
        .0209664;
        -.00592962;
        -.00787371;
        -.000759247;
        .000331948;
        -.000382725;
        -.00031775;
        9.34573e-5;
        -9.01241e-5;
        -.000641342;
        -.00101676;
        -.000897311;
        -.000275065;
        .000349352;
        .000351448;
        -.000323009;
        -.000974217;
        -.00103001;
        -.000436473;
        .000403975;
        .000967099;
        .000817466;
        5.04233e-5;
        -.000682881;
        -.00105098;
        -.000894036;
        -.000298564;
        .00013839;
        -.000220119;
        -.000913083;
        -.00098678;
        -.000246487;
        .00115744;
        .00225056;
        .00209313;
        .00114718;
        .000408921;
        .000440286;
        .00115373;
        .00182241;
        .00202494;
        .00175423;
        .00115433;
        .000689664;
        .000366708;
        .000159357;
        9.30144e-6;
        4.13063e-6;
        -3.98743e-5;
        -.000633551;
        -.00150708;
        -.00294477];

 h_bb = [.0222325;
        -.0139671;
        -.0305184;
        -.0307636;
        -.0101165;
        -.000200581;
        .00550817;
        -.00149264;
        -.0170492;
        -.0268676;
        -.0214635;
        .00134159;
        .0226597;
        .0225511;
        .00109679;
        -.0224108;
        -.0280385;
        -.0228094;
        -.00268563;
        .0137355;
        .0180825;
        .0111368;
        -.0149742;
        -.0294231;
        -.0306827;
        -.0160451;
        .0032811;
        -.00678058;
        -.026303;
        -.0364341;
        -.0413457;
        -.0178154;
        .0100546;
        .0190829;
        .0319895;
        .0257628;
        .0164719;
        .0208493;
        .0180724;
        .0281953;
        .0257796;
        .00913213;
        .00850601;
        .0231608;
        .0431035;
        .0528096;
        .0500973;
        .0313528;
        .0256348;
        .0451643;
        .0536033;
        .0403724;
        .0281472;
        .0119722;
        9.23611e-6;
        -.0337887;
        -.0992857;
        -.123698;
        -.0714675;
        .0238356;
        .0697147;
        .0271743;
        -.0606042;
        -.120834;
        -.0925527;
        -.0243003;
        -.00196787;
        -.0208312;
        -.0673055;
        -.115875;
        -.0792391;
        -.00596349;
        .0874122;
        .176433;
        .12259;
        .0391578;
        .00138033;
        -.0276105;
        -.00353472;
        .01858;
        .00183158;
        -.0110577;
        -.00393337;
        .00570718;
        .0029915;
        -.00199942;
        -.00130829;
        .00114979;
        .00107999;
        -.000411593;
        -.000745858;
        -.000142838;
        .000160664;
        .000110064;
        -.000227725;
        -.000354958;
        -.00034311;
        -.000254735;
        -.000147984;
        -2.7051e-7;
        1.18658e-5;
        -7.15179e-5;
        1.8272e-5;
        .000132489;
        .000585346;
        .00107692;
        .00106946;
        .00112041;
        .000995935;
        .000797515;
        .00122163;
        .0013991;
        .00106644;
        .00100282;
        .000814768;
        .000801713;
        .000838398;
        .000536345;
        .000387848;
        .000319982;
        8.47191e-5;
        -.000361454;
        -.000511269;
        -.000703714;
        -.000801431;
        -.000726675;
        -.00130935;
        -.00205656];

 h_bb2sin = [.0217461;
        -.0164974;
        -.033708;
        -.0349291;
        -.0127497;
        -.00465969;
        .000563782;
        -.00514913;
        -.0186947;
        -.0285336;
        -.0240213;
        -.00135263;
        .0207963;
        .0212745;
        .000250887;
        -.0229424;
        -.0272256;
        -.0215605;
        -.00101373;
        .0152345;
        .0190469;
        .0126293;
        -.0131939;
        -.0266963;
        -.0273435;
        -.0126104;
        .00654626;
        -.00423189;
        -.0237024;
        -.0319275;
        -.036903;
        -.0138668;
        .013459;
        .0200862;
        .0329395;
        .0266498;
        .0160463;
        .0199025;
        .0150944;
        .0256663;
        .0236577;
        .005528;
        .00469224;
        .0193236;
        .0393915;
        .0495747;
        .0475515;
        .0275647;
        .021408;
        .0431827;
        .0533126;
        .03912;
        .026313;
        .0104934;
        .00237845;
        -.0276268;
        -.0951662;
        -.122519;
        -.0705127;
        .0274033;
        .0743637;
        .0301029;
        -.0589393;
        -.119456;
        -.0895862;
        -.0202064;
        -.000919056;
        -.0213271;
        -.0652799;
        -.1139;
        -.0786366;
        -.00918063;
        .0842757;
        .178637;
        .121702;
        .0356804;
        -.000987128;
        -.0309118;
        -.00630541;
        .015878;
        -.00242786;
        -.0156923;
        -.00609566;
        .0052158;
        .000475123;
        -.00576954;
        -.00350706;
        .00084783;
        .0011167;
        -.000274508;
        .00010957;
        .0016233;
        .00264141;
        .00231896;
        .00231579;
        .00272708;
        .00288061;
        .00336748;
        .00319252;
        .00300285;
        .0030219;
        .0025936;
        .00197251;
        .00117409;
        .000869601;
        .000758443;
        .000597427;
        .000185713;
        -.000718848;
        -.00149134;
        -.00198242;
        -.00209238;
        -.00188984;
        -.00190485;
        -.00192952;
        -.00213428;
        -.00247452;
        -.00243152;
        -.00236441;
        -.00213092;
        -.00174564;
        -.00132817;
        -.00114774;
        -.00120431;
        -.00102358;
        -.000670235;
        -5.95363e-5;
        .000490485];


 h_sin = [.00663015;
        .00806223;
        .00927074;
        .0102207;
        .0108817;
        .011237;
        .0112695;
        .0109839;
        .0103765;
        .00947293;
        .00829003;
        .00686521;
        .00523456;
        .003444;
        .00154857;
        -.000404221;
        -.00235422;
        -.00424671;
        -.00602848;
        -.00764406;
        -.00904939;
        -.0102026;
        -.0110695;
        -.0116232;
        -.0118452;
        -.0117276;
        -.0112738;
        -.0104933;
        -.00940503;
        -.00804141;
        -.0064371;
        -.00464065;
        -.00269783;
        -.000669309;
        .00139197;
        .00342372;
        .00536669;
        .0071663;
        .00876811;
        .010126;
        .0111974;
        .0119529;
        .0123668;
        .0124258;
        .0121253;
        .0114744;
        .0104846;
        .00918922;
        .00761866;
        .00581987;
        .0038405;
        .00174017;
        -.000422484;
        -.00258686;
        -.00468777;
        -.00666428;
        -.00845969;
        -.0100202;
        -.0112981;
        -.0122562;
        -.0128646;
        -.0131038;
        -.0129642;
        -.0124472;
        -.0115654;
        -.0103411;
        -.00881047;
        -.00701395;
        -.00500402;
        -.00283607;
        -.000575048;
        .00171433;
        .00396771;
        .00611868;
        .00810276;
        .00986459;
        .0113473;
        .0125109;
        .0133165;
        .013737;
        .0137617;
        .0133858;
        .0126164;
        .0114746;
        .00999364;
        .00821312;
        .00618182;
        .00395883;
        .00160842;
        -.000802216;
        -.00320317;
        -.0055253;
        -.00769796;
        -.00966098;
        -.0113504;
        -.0127209;
        -.0137271;
        -.0143369;
        -.0145329;
        -.0143063;
        -.0136594;
        -.01261;
        -.0111866;
        -.00942915;
        -.00738496;
        -.0051152;
        -.00268122;
        -.000155822;
        .00239188;
        .00488334;
        .00724796;
        .00941307;
        .011316;
        .012901;
        .0141146;
        .0149268;
        .0153042;
        .0152393;
        .0147274;
        .0137826;
        .0124274;
        .0107042;
        .00865289;
        .00633976;
        .00382403;
        .00118302;
        -.00150644;
        -.00416726];

%% Question 2_3

f_s = 16000;    % Hz
h = flipud(h_sin);
%h = flipud(h_bb);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h-sin(n)'
set(gca,'LooseInset',get(gca,'TightInset'))

% figure('Color','white');
% subplot(2,1,1);
% plot(w/f_s,20*log10(abs(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
% subplot(2,1,2)
% plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
% set(gca,'LooseInset',get(gca,'TightInset'))