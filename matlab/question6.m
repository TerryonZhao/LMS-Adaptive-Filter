close all;
clc;

h_bb = [.00684403;
        .00363379;
        .00208029;
        .00107752;
        .00203895;
        .00261083;
        .00203978;
        .000953095;
        .000291685;
        -.00053657;
        -.00222657;
        -.00270972;
        -.0017938;
        -.00101812;
        -.000240766;
        -.000676299;
        -.00187817;
        -.00191475;
        -.000650397;
        .00249705;
        .00556837;
        .00562475;
        .00342817;
        -4.26026e-6;
        -.00276659;
        -.00227181;
        -.000120059;
        .0011663;
        -1.84761e-5;
        -.00315034;
        -.00550329;
        -.00534354;
        -.00311127;
        -.00101159;
        -.000443523;
        -.00282706;
        -.0053308;
        -.00520538;
        -.00534983;
        -.00479655;
        -.00218402;
        -.000977184;
        -.000120914;
        .000534644;
        -.00148012;
        -.00162277;
        .00156151;
        .00392032;
        .00497466;
        .00361529;
        .0023518;
        .00365436;
        .00427325;
        .00336777;
        .00237916;
        .0044843;
        .00943918;
        .0139469;
        .0132222;
        .00591549;
        .00353746;
        .00560257;
        .00589127;
        .00972512;
        .00840007;
        .00501694;
        .00512088;
        -.00368918;
        -.0155739;
        -.0177344;
        -.00986285;
        .00445915;
        .00835642;
        -.00365047;
        -.0184098;
        -.0280874;
        -.0209118;
        -.00786082;
        -.00355746;
        -.00854181;
        -.016012;
        -.0138217;
        -.00495386;
        .0129404;
        .0311299;
        .0272714;
        .0136718;
        .00394911;
        -.00464037;
        -.0030623;
        .00280969;
        .00209256;
        -.000575867;
        -.000880973;
        .000256891;
        .000670287;
        .000217514;
        -7.05844e-5;
        -.000202786;
        -6.13217e-5;
        3.87629e-5;
        4.1238e-5;
        .000146986;
        7.60645e-5;
        .000108421;
        .000109668;
        .000120578;
        .000116766;
        .000219259;
        .000228004;
        .00024062;
        .0002862;
        .000319348;
        .000298654;
        .000316537;
        .000363361;
        .000284048;
        .000307887;
        .000301456;
        .000267933;
        .000236944;
        .000244635;
        .000153366;
        .00022528;
        .000145845;
        .000108487;
        .000105747;
        -3.06812e-5;
        3.65308e-5;
        5.51482e-5;
        5.51479e-5;
        -3.87309e-5;
        -1.40689e-5;
        8.89181e-5;
        .000135726;
        .00019898;
        1.86282e-5;
        -7.70652e-5;
        -7.11117e-5;
        .000152089]; 

h_bb_sat = [-.000461035;
        6.10513e-5;
        .0357479;
        .053931;
        .0538016;
        .0327442;
        .00318458;
        -.0283635;
        -.0416796;
        -.0182364;
        -.00467007;
        .0210855;
        .0226383;
        -.00227793;
        -.0289486;
        -.0606008;
        -.0378592;
        -.00654297;
        .0295281;
        .0316473;
        -.0146703;
        -.0508982;
        -.0689689;
        -.0269935;
        .0262282;
        .0454136;
        .0214256;
        -.0151059;
        -.0379548;
        -.04241;
        -.0236886;
        -.00873384;
        .00925233;
        .0200359;
        .0124524;
        .000347344;
        -.0139342;
        -.00382403;
        .0193452;
        .032597;
        .0305566;
        .00446733;
        -.0236722;
        -.0213459;
        .00764134;
        .027459;
        .0336011;
        .0230552;
        -.024678;
        -.0365973;
        .000947153;
        .0401565;
        .0639395;
        .054541;
        .0216431;
        .0028879;
        .00912031;
        .0177065;
        .0162655;
        .00646214;
        .0137761;
        -.00378494;
        -.026675;
        -.0237031;
        -.0283159;
        -.0114192;
        .00832266;
        -.00728964;
        -.0366242;
        -.0487589;
        -.0267101;
        -.0052319;
        .000464985;
        -.0208735;
        -.0489144;
        -.082518;
        -.0749557;
        -.0132526;
        .0384427;
        .0762891;
        .0638033;
        .0269507;
        -.0118486;
        -.0218034;
        -.00136636;
        .0108624;
        .0101132;
        .00223879;
        -.00871963;
        -.0146488;
        -.00757187;
        -.00471299;
        .019196;
        .0332467;
        .0276206;
        .0185888;
        -.00659644;
        -.0170279;
        -.0139066;
        -.0047809;
        -.00377109;
        -.0189719;
        -.0122396;
        .0154384;
        .0414712;
        .0258055;
        .00715055;
        -.0133662;
        -.0221351;
        .0107404;
        .0325941;
        .00667296;
        -.0191033;
        -.0233031;
        -.0267041;
        -.00697397;
        .0138359;
        .00328565;
        -.0131978;
        -.0190197;
        -.0224286;
        .00511912;
        .00335153;
        -.0105048;
        -.012392;
        -.0102483;
        .0162093;
        .0196534];


%% Question 6

f_s = 16000;    % Hz
h = flipud(h_bb_sat);
%h = flipud(h_bb);
[H,w] = freqz(h,1,512,f_s); %'whole',


figure('Color','white')
stem(0:numel(h)-1, h); grid on;
xlabel 'Samples', ylabel 'h(n) - Filter coefficients', title 'Estimated Filter h(n)'
set(gca,'LooseInset',get(gca,'TightInset'))
% 
% figure('Color','white');
% subplot(2,1,1);
% plot(w/f_s,20*log10(abs(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Magnitude (dB)', title 'Estimated Filter H(w)'
% subplot(2,1,2)
% plot(w/f_s, 180/pi*wrapToPi(angle(H))); grid on;
% xlabel 'Normalized Frequency (\times \pi [rad/sample])', ylabel 'Phase (degrees)'
% set(gca,'LooseInset',get(gca,'TightInset'))